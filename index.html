<!doctype html>
<!--[if lt IE 7]>      <html class="no-js lt-ie9 lt-ie8 lt-ie7" lang=""> <![endif]-->
<!--[if IE 7]>         <html class="no-js lt-ie9 lt-ie8" lang=""> <![endif]-->
<!--[if IE 8]>         <html class="no-js lt-ie9" lang=""> <![endif]-->
<!--[if gt IE 8]><!-->
<html class="no-js" lang="">
<!--<![endif]-->

<head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">
    <title>Mount Olympus</title>
    <meta name="description" content="">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <!--Bootstrap -->
    <!-- Latest compiled and minified CSS -->
    <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/css/bootstrap.min.css" integrity="sha384-BVYiiSIFeK1dGmJRAkycuHAHRg32OmUcww7on3RYdg4Va+PmSTsz/K68vbdEjh4u" crossorigin="anonymous">
    <!-- Optional theme -->
    <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/css/bootstrap-theme.min.css" integrity="sha384-rHyoN1iRsVXV4nD0JutlnGaslCJuC7uwjduW9SVrLvRYooPp2bWYgmgJQIXwl/Sp" crossorigin="anonymous">
    <link rel="stylesheet" href="assets/css/style.css">
    <!-- Latest compiled and minified JavaScript -->
    <script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/js/bootstrap.min.js" integrity="sha384-Tc5IQib027qvyjSMfHjOMaLkfuWVxZxUPnCJA7l2mCWNIpG9mGCD8wGNIcPD7Txa" crossorigin="anonymous"></script>
    <script src="js/vendor/modernizr-2.8.3-respond-1.4.2.min.js"></script>
</head>

<body>
    <!--[if lt IE 8]>
            <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="http://browsehappy.com/">upgrade your browser</a> to improve your experience.</p>
        <![endif]-->
    <div class="container">
        <div class="row">
            <div class="col-sm-12">
                <h1>Mount Olympus</h1>
                <input type="file" id="files" name="file" onchange='openFile(event)' />
                <br>
                <button onclick="readFile()">Print File</button>
                <div id="byte_content"></div>
                <div id="read_text"></div>
                <div id="array"></div>
                <div id="print_array"></div>
            </div>
        </div>
        <!--Creating the game space here -->
        <div class="row">
            <div class="col-sm-1">
            </div>
        </div>
    </div>

    <!--https://www.html5rocks.com/en/tutorials/file/dndfiles/
  https://developer.mozilla.org/en-US/docs/Web/API/FileReader
http://www.javascripture.com/FileReader
-->
    <script>
        /*  function readFile() {
                var files = document.getElementById('files').files;
                if (!files.length) {
                  alert('Please select a file!');
                  return;
                }
                var file = files[0];
                var reader = new FileReader();
                // If we use onloadend, we need to check the readyState.
                reader.onloadend = function(evt) {
                  if (evt.target.readyState == FileReader.DONE) { // DONE == 2
                    document.getElementById('byte_content').textContent = evt.target.result;
                  }
                };
                reader.readAsBinaryString(file);
              }*/
        /*global variables*/
        var start, finish, gridwidth;
        var openFile = function(event) {
            var input = event.target;
            var reader = new FileReader();
            reader.onload = function() {
                var text = reader.result;
                console.log(typeof reader.result); //double checking that this is a string
                //var output = reader.result.substring(0, 200); //gets the first 200 characters
                //now with our text we need to parse the string
                var new_text = text.split(/[()]+/); //this splits the strings by the parentheses
                console.log("printing out the text using the console.table");
                console.table(new_text);
                printGrid(new_text);
                findStart(new_text);
              /*this piece of code may be unnecessary
                var indexes = []; //this will store all of the indexes in the array that is of the ' tile'
                for (var i = 0; i < new_text.length; i++) {
                    if (new_text[i] === " tile") {
                        indexes.push(i + 1); //we know that for ever instance of the tile we know that the coordinates of that tile is index[i]+1;
                    }
                }
                console.table(indexes);*/
                document.getElementById('read_text').innerHTML = new_text;
                /*in this part of the parsing I am splicing the array at the completed text, since all of the level_design coordinates listed for the wall, touch, gem and altar are the same as the previous coordinates. This will prevent any redrawing of a tile*/
                var splicelocation = new_text.indexOf(' completed __level_design');
                console.log("Location to splice at: " + splicelocation);
                var newText = new_text.splice(0, splicelocation);
                console.table(newText);
                document.getElementById('array').innerHTML = newText;

                /*touch
                touch((3,1),2)
                for the touch the third value after the coordinates is the number of times a user must touch the block to advance*/
                /*creating objects for the tiles based on the touch as well*/
                //this is an example of what properties the tile should have
                var Tiles = {
                  coordinate:"3,5", //it is the coordinate
                  touch:2, //can be 1,2,3
                  sprite:"default" //can be a wall, altar, gem, or the default tile
                };


            };
            reader.readAsText(input.files[0]);
        };

        var findStart = function(x) {
            var startLocation = x.indexOf(' start') + 1; //this is finding the position of where 'start' is
            var finishLocation = x.indexOf(' finish') + 1; //this is finding the position of where 'finish' is
            start = x[startLocation]; //this is the start coordinates
            finish = x[finishLocation]; //this is the end coordinates
            console.log(start);
            console.log(finish);
            return start, finish;
        }
        var printGrid = function(x) {
                var width = x[1];
                console.log(width);
                var size = width.split(",");
                gridwidth = size[1]; //this is the width of the grid
                console.log(gridwidth);
                return gridwidth; //now we know the width of the grid and assuming that it will always be a square we know that the height is also the same as the width
            }
            /*from the output we know the tiles and the adj and the type of tiles*/
    </script>
</body>

</html>
